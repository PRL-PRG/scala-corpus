# absolute path to the ivy directory that contains cache and local subdirs
ifndef GLOBAL_IVY_DIR
$(error GLOBAL_IVY_DIR is not set. Typically ~/.ivy2)
endif

# absolute path to the prepopulated sbt-boot directory
ifndef GLOBAL_SBT_BOOT_DIR
$(error GLOBAL_SBT_BOOT_DIR is not set. Typically ~/.sbt/boot)
endif

ANALYSIS_DIR := _analysis_
IVY_DIR := .ivy
SBT_BOOT_DIR := .sbt-boot

SBT_MEM := 16000

$(IVY_DIR):
	mkdir -p $(IVY_DIR)
	ln -sf $(GLOBAL_IVY_CACHE_DIR)/cache $(IVY_DIR)
	ln -sf $(GLOBAL_IVY_CACHE_DIR)/local $(IVY_DIR)

$(SBT_BOOT_DIR):
	mkdir -p $(SBT_BOOT_DIR)
	ls -1 $(GLOBAL_SBT_BOOT_DIR) | grep "^scala-" | parallel ln -sf "$(GLOBAL_SBT_BOOT_DIR)/{1}" "$(SBT_BOOT_DIR)/${1}"
